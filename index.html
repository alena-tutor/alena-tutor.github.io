  function renderSettings(main){
    const card=document.createElement("section");
    card.className="card";

    const header=document.createElement("div");
    header.className="card-header";
    const left=document.createElement("div");
    const title=document.createElement("div");
    title.className="card-title";
    title.textContent="Настройки";
    const subtitle=document.createElement("div");
    subtitle.className="card-subtitle";
    subtitle.textContent="Часовой пояс и управление данными.";
    left.appendChild(title);
    left.appendChild(subtitle);
    header.appendChild(left);
    card.appendChild(header);

    /* Блок: часовой пояс */
    const block=document.createElement("div");
    block.className="form-section";

    const tzRow=document.createElement("div");
    tzRow.className="form-row";
    const lbl=document.createElement("div");
    lbl.className="form-label";
    lbl.textContent="Часовой пояс преподавателя";
    const sel=document.createElement("select");
    sel.className="form-select";
    ALL_TZ.forEach(tz=>{
      const opt=document.createElement("option");
      opt.value=tz;opt.textContent=tz;
      if(tz===data.tutorTZ) opt.selected=true;
      sel.appendChild(opt);
    });
    sel.onchange=()=>{
      data.tutorTZ=sel.value;
      save();
    };
    tzRow.appendChild(lbl);
    tzRow.appendChild(sel);

    block.appendChild(tzRow);
    card.appendChild(block);

    /* Блок: резервное копирование */
    const backup=document.createElement("div");
    backup.className="form-section";

    const bTitle=document.createElement("div");
    bTitle.className="card-title";
    bTitle.style.fontSize="13px";
    bTitle.textContent="Резервное копирование (экспорт / импорт)";
    const bText=document.createElement("div");
    bText.className="tiny";
    bText.innerHTML =
      "Экспорт создаёт текст с данными (ученики, уроки, абонементы, КТП). " +
      "Сохрани этот текст в файл/заметки. При импорте вставь его обратно и нажми «Импортировать».";

    const bRow=document.createElement("div");
    bRow.className="form-row";
    const bLbl=document.createElement("div");
    bLbl.className="form-label";
    bLbl.textContent="Текст резервной копии (JSON)";
    const backupArea=document.createElement("textarea");
    backupArea.placeholder = "Нажми «Экспортировать данные» — здесь появится текст.\n" +
                              "Скопируй его и сохрани. Чтобы восстановить — вставь сюда сохранённый текст и нажми «Импортировать данные».";
    bRow.appendChild(bLbl);
    bRow.appendChild(backupArea);

    const bActions=document.createElement("div");
    bActions.className="form-actions";
    const btnExport=document.createElement("button");
    btnExport.className="btn-secondary";
    btnExport.textContent="Экспортировать данные в текст ниже";
    btnExport.onclick=()=>{
      try{
        const json = JSON.stringify(data,null,2);
        backupArea.value = json;
        backupArea.focus();
        backupArea.select();
        alert("Данные выгружены. Скопируй текст и сохрани его в безопасном месте.");
      }catch(e){
        console.error(e);
        alert("Не удалось экспортировать данные.");
      }
    };

    const btnImport=document.createElement("button");
    btnImport.className="btn-main";
    btnImport.textContent="Импортировать данные из текста";
    btnImport.onclick=()=>{
      const text = backupArea.value.trim();
      if(!text){
        alert("Вставь сюда текст резервной копии.");
        return;
      }
      if(!confirm("Текущие данные будут заменены данными из текста. Продолжить?")){
        return;
      }
      try{
        const parsed = JSON.parse(text);
        if(!parsed || typeof parsed!=="object" || !Array.isArray(parsed.students)){
          alert("Похоже, это не резервная копия этого кабинета (нет поля students).");
          return;
        }
        // Сохраняем сырые данные и заново инициализируем через loadData(),
        // чтобы добавить недостающие поля/структуру.
        localStorage.setItem(STORAGE_KEY, text);
        data = loadData();
        render();
        alert("Данные успешно импортированы.");
      }catch(e){
        console.error(e);
        alert("Ошибка при разборе JSON. Проверь, что текст не повреждён.");
      }
    };

    bActions.appendChild(btnExport);
    bActions.appendChild(btnImport);

    backup.appendChild(bTitle);
    backup.appendChild(bText);
    backup.appendChild(bRow);
    backup.appendChild(bActions);

    card.appendChild(backup);

    /* Блок: полный сброс */
    const danger=document.createElement("div");
    danger.className="form-section";
    danger.style.background="#f7d1d5";
    danger.style.borderColor="#e4a7af";

    const dTitle=document.createElement("div");
    dTitle.className="card-title";
    dTitle.style.fontSize="13px";
    dTitle.textContent="Сбросить кабинет";
    const dText=document.createElement("div");
    dText.className="tiny";
    dText.textContent="Удалит всех учеников, уроки и абонементы из этого браузера. Назад вернуть нельзя (если нет резервной копии).";
    const btnReset=document.createElement("button");
    btnReset.className="btn-danger";
    btnReset.textContent="Удалить все данные";
    btnReset.onclick=()=>{
      if(confirm("Точно удалить ВСЕ данные (учеников, уроки, абонементы, КТП)?")) {
        localStorage.removeItem(STORAGE_KEY);
        data = loadData();
        render();
      }
    };

    danger.appendChild(dTitle);
    danger.appendChild(dText);
    danger.appendChild(btnReset);

    card.appendChild(danger);

    main.appendChild(card);
  }

